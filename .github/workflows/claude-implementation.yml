name: Claude Issue Implementation

on:
  issue_comment:
    types: [created]

jobs:
  implement-issue:
    runs-on: ubuntu-latest
    if: contains(github.event.comment.body, '/claude-implement')
    permissions:
      contents: write
      pull-requests: write
      issues: write
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - name: Comment on issue
        run: |
          gh issue comment ${{ github.event.issue.number }} --body "ðŸ¤– Starting work on this issue..."
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      
      - name: Create test PR
        run: |
          # Setup Git
          git config user.name "GitHub Actions"
          git config user.email "actions@github.com"
          
          # Create branch
          BRANCH_NAME="issue-${{ github.event.issue.number }}-test"
          git checkout -b $BRANCH_NAME
          
          # Create test file
          echo "# Test implementation for issue #${{ github.event.issue.number }}" > test.md
          
          # Commit and push
          git add test.md
          git commit -m "Test implementation for #${{ github.event.issue.number }}"
          git push origin $BRANCH_NAME
          
          # Create PR with simple body
          gh pr create --title "Test Fix for #${{ github.event.issue.number }}" --body "Test PR for #${{ github.event.issue.number }}" --base main
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}